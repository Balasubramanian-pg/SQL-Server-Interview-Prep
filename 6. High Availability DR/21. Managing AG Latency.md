# 21. Managing AG Latency

Canonical documentation for 21. Managing AG Latency. This document defines the conceptual model, terminology, and standard usage patterns.

> [!NOTE]
> This documentation is implementation-agnostic and intended to serve as a stable reference.

## 1. Purpose and Problem Space
Describe why 21. Managing AG Latency exists and the class of problems it addresses.
The purpose of managing AG latency is to minimize the delay between the time data is written to the primary replica and the time it becomes available on the secondary replicas. This is crucial in AlwaysOn Availability Groups (AGs) as high latency can lead to data inconsistencies, decreased performance, and increased risk of data loss. The class of problems it addresses includes ensuring data availability, maintaining data consistency, and optimizing system performance.

## 2. Conceptual Overview
Provide a high-level mental model of the topic.
Managing AG latency involves understanding the factors that contribute to latency, such as network bandwidth, disk I/O, and log send and redo rates. It also requires knowledge of the AG architecture, including the primary and secondary replicas, and the communication pathways between them. By grasping these concepts, database administrators can design and implement strategies to minimize latency and ensure high availability.

## 3. Terminology and Definitions
| Term | Definition |
|------|------------|
| AG | AlwaysOn Availability Group, a high-availability and disaster-recovery solution in SQL Server |
| Latency | The delay between the time data is written to the primary replica and the time it becomes available on the secondary replicas |
| Primary Replica | The primary database in an AG that accepts writes and is the single source of truth |
| Secondary Replica | A read-only copy of the primary database that is kept in sync with the primary replica |
| Log Send Rate | The rate at which the primary replica sends log records to the secondary replicas |
| Redo Rate | The rate at which the secondary replicas apply log records to their local databases |

## 4. Core Concepts
Explain the fundamental ideas that form the basis of this topic.
The core concepts of managing AG latency include:
* Understanding the AG architecture and communication pathways
* Identifying and mitigating factors that contribute to latency, such as network bandwidth and disk I/O
* Monitoring and optimizing log send and redo rates
* Configuring and tuning AG settings, such as the log send and redo queue sizes
* Implementing strategies to reduce latency, such as increasing network bandwidth and optimizing disk I/O

## 5. Standard Model
Describe the generally accepted or recommended model.
The standard model for managing AG latency involves:
* Implementing a high-performance network infrastructure to support log send and redo operations
* Configuring AG settings to optimize log send and redo rates
* Monitoring AG latency and performance metrics, such as log send and redo queue sizes
* Implementing strategies to reduce latency, such as increasing network bandwidth and optimizing disk I/O
* Regularly reviewing and adjusting the AG configuration to ensure optimal performance

## 6. Common Patterns
Document recurring, accepted patterns.
Common patterns for managing AG latency include:
* Implementing a dedicated network for AG communication
* Using high-performance storage solutions, such as SSDs, to optimize disk I/O
* Configuring AG settings to prioritize log send and redo operations
* Implementing load balancing and failover strategies to ensure high availability
* Regularly monitoring and analyzing AG performance metrics to identify areas for improvement

## 7. Anti-Patterns
Describe common but discouraged practices.
Anti-patterns for managing AG latency include:
* Using low-bandwidth networks for AG communication
* Configuring AG settings to prioritize other operations over log send and redo operations
* Failing to monitor and analyze AG performance metrics
* Implementing inadequate load balancing and failover strategies
* Ignoring or neglecting AG maintenance and upkeep tasks

## 8. References
Provide exactly five authoritative external references.
1. Microsoft. (2022). AlwaysOn Availability Groups (SQL Server). Retrieved from <https://docs.microsoft.com/en-us/sql/database-engine/availability-groups/windows/always-on-availability-groups-sql-server>
2. SQL Server Documentation. (2022). Monitor Availability Groups. Retrieved from <https://docs.microsoft.com/en-us/sql/database-engine/availability-groups/windows/monitor-availability-groups>
3. Microsoft. (2022). Troubleshoot Availability Group Issues. Retrieved from <https://docs.microsoft.com/en-us/sql/database-engine/availability-groups/windows/troubleshoot-availability-group-issues>
4. SQL Server Documentation. (2022). Configure Availability Group Properties. Retrieved from <https://docs.microsoft.com/en-us/sql/database-engine/availability-groups/windows/configure-availability-group-properties>
5. Microsoft. (2022). Performance Considerations for AlwaysOn Availability Groups. Retrieved from <https://docs.microsoft.com/en-us/sql/database-engine/availability-groups/windows/performance-considerations-for-always-on-availability-groups>

## 9. Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-02-14 | Initial documentation |