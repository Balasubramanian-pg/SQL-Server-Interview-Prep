# 37. Query Store: Hints and Forcing Plans

Canonical documentation for 37. Query Store: Hints and Forcing Plans. This document defines the conceptual model, terminology, and standard usage patterns.

> [!NOTE]
> This documentation is implementation-agnostic and intended to serve as a stable reference.

## 1. Purpose and Problem Space
Describe why 37. Query Store: Hints and Forcing Plans exists and the class of problems it addresses.
The Query Store feature in SQL Server is designed to address the problem of query performance variability and plan choice issues. It provides a mechanism to capture and analyze query plans, as well as to force specific plans for problematic queries. This helps database administrators to identify and resolve performance issues, and to ensure consistent query performance over time.

## 2. Conceptual Overview
Provide a high-level mental model of the topic.
The Query Store is a repository that stores information about query plans, including the plan itself, execution statistics, and other relevant data. It provides a way to track query performance over time, identify regressions, and analyze plan changes. The Query Store also enables the forcing of specific plans for queries, which can help to resolve performance issues caused by plan choice problems.

## 3. Terminology and Definitions
| Term | Definition |
|------|------------|
| Query Store | A repository that stores information about query plans, including the plan itself, execution statistics, and other relevant data. |
| Query Plan | A set of operations that the database engine uses to execute a query. |
| Plan Forcing | The process of specifying a particular query plan to be used for a query, rather than allowing the database engine to choose the plan. |
| Query Hint | A directive that provides additional information to the database engine about how to execute a query. |

## 4. Core Concepts
Explain the fundamental ideas that form the basis of this topic.
The core concepts of Query Store: Hints and Forcing Plans include:
* **Query Plan Management**: The ability to capture, analyze, and manage query plans.
* **Plan Forcing**: The ability to specify a particular query plan to be used for a query.
* **Query Hints**: Directives that provide additional information to the database engine about how to execute a query.
* **Performance Monitoring**: The ability to track query performance over time and identify regressions.

## 5. Standard Model
Describe the generally accepted or recommended model.
The standard model for Query Store: Hints and Forcing Plans involves the following steps:
1. **Enable Query Store**: Enable the Query Store feature on the database.
2. **Configure Query Store**: Configure the Query Store to capture query plans and execution statistics.
3. **Analyze Query Performance**: Analyze query performance data to identify problematic queries.
4. **Force Query Plans**: Force specific query plans for problematic queries.
5. **Monitor Performance**: Monitor query performance over time to ensure that the forced plans are effective.

## 6. Common Patterns
Document recurring, accepted patterns.
Common patterns for Query Store: Hints and Forcing Plans include:
* **Using Query Hints to Influence Plan Choice**: Using query hints to influence the plan choice for a query.
* **Forcing Plans for Problematic Queries**: Forcing specific plans for queries that are experiencing performance issues.
* **Monitoring Query Performance**: Monitoring query performance over time to identify regressions and optimize query plans.

## 7. Anti-Patterns
Describe common but discouraged practices.
Anti-patterns for Query Store: Hints and Forcing Plans include:
* **Over-Reliance on Query Hints**: Over-relying on query hints to fix performance issues, rather than addressing the underlying problems.
* **Forcing Plans Without Analysis**: Forcing plans without analyzing query performance data and understanding the underlying issues.
* **Failing to Monitor Performance**: Failing to monitor query performance over time, which can lead to regressions and performance issues.

## 8. References
Provide exactly five authoritative external references.
1. [Microsoft Documentation: Query Store](https://docs.microsoft.com/en-us/sql/relational-databases/performance/monitoring-performance-by-using-the-query-store)
2. [SQL Server Query Store: A Game Changer for Performance Tuning](https://www.sqlshack.com/sql-server-query-store-game-changer-performance-tuning/)
3. [Query Store: Forcing Query Plans](https://www.brentozar.com/archive/2016/06/query-store-forcing-query-plans/)
4. [Using Query Hints to Influence Plan Choice](https://www.sqlservercentral.com/articles/using-query-hints-to-influence-plan-choice)
5. [Query Store Best Practices](https://www.mssqltips.com/sqlservertip/4551/sql-server-2016-query-store-best-practices/)

## 9. Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-02-14 | Initial documentation |