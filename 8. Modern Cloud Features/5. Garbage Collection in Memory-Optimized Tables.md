# 5. Garbage Collection in Memory-Optimized Tables

Canonical documentation for 5. Garbage Collection in Memory-Optimized Tables. This document defines the conceptual model, terminology, and standard usage patterns.

> [!NOTE]
> This documentation is implementation-agnostic and intended to serve as a stable reference.

## 1. Purpose and Problem Space
Describe why 5. Garbage Collection in Memory-Optimized Tables exists and the class of problems it addresses.
Garbage collection in memory-optimized tables is a critical mechanism that addresses the problem of efficient memory management in databases. Memory-optimized tables, also known as in-memory tables, store data in the main memory (RAM) instead of on disk, providing faster access and improved performance. However, this approach also introduces the challenge of managing memory to ensure that it does not become fragmented or exhausted. Garbage collection is designed to reclaim memory occupied by deleted or updated rows, ensuring that the database remains performant and reliable.

## 2. Conceptual Overview
Provide a high-level mental model of the topic.
The conceptual overview of garbage collection in memory-optimized tables involves understanding how the database manages memory allocation and deallocation. When a row is inserted, updated, or deleted, the database allocates or deallocates memory accordingly. Over time, this can lead to memory fragmentation, where free memory is broken into small, non-contiguous blocks. Garbage collection is the process of identifying and reclaiming these fragmented blocks, consolidating them into larger, contiguous blocks that can be reused.

## 3. Terminology and Definitions
| Term | Definition |
|------|------------|
| Memory-Optimized Table | A table that stores data in the main memory (RAM) instead of on disk. |
| Garbage Collection | The process of reclaiming memory occupied by deleted or updated rows. |
| Memory Fragmentation | The division of free memory into small, non-contiguous blocks. |
| Allocation | The process of assigning memory to a row or object. |
| Deallocation | The process of releasing memory assigned to a row or object. |

## 4. Core Concepts
Explain the fundamental ideas that form the basis of this topic.
The core concepts of garbage collection in memory-optimized tables include:
* **Memory allocation**: The database allocates memory to store rows and objects.
* **Memory deallocation**: The database releases memory when rows or objects are deleted or updated.
* **Memory fragmentation**: The division of free memory into small, non-contiguous blocks.
* **Garbage collection**: The process of identifying and reclaiming fragmented blocks, consolidating them into larger, contiguous blocks.

## 5. Standard Model
Describe the generally accepted or recommended model.
The standard model for garbage collection in memory-optimized tables involves a periodic or event-driven process that:
1. Identifies deleted or updated rows.
2. Reclaims memory allocated to these rows.
3. Consolidates fragmented blocks into larger, contiguous blocks.
This model ensures that memory is efficiently managed, reducing the risk of memory exhaustion and fragmentation.

## 6. Common Patterns
Document recurring, accepted patterns.
Common patterns for garbage collection in memory-optimized tables include:
* **Periodic garbage collection**: The database runs garbage collection at regular intervals (e.g., every hour).
* **Event-driven garbage collection**: The database runs garbage collection in response to specific events (e.g., when a table is updated).
* **Concurrent garbage collection**: The database runs garbage collection concurrently with other database operations.

## 7. Anti-Patterns
Describe common but discouraged practices.
Anti-patterns for garbage collection in memory-optimized tables include:
* **Manual memory management**: Developers manually managing memory allocation and deallocation, which can lead to memory leaks and fragmentation.
* **Inadequate garbage collection**: Failing to run garbage collection regularly or in response to events, leading to memory exhaustion and fragmentation.
* **Overly aggressive garbage collection**: Running garbage collection too frequently, leading to performance degradation and unnecessary overhead.

## 8. References
Provide exactly five authoritative external references.
1. Microsoft. (2022). Garbage Collection in Memory-Optimized Tables. Retrieved from <https://docs.microsoft.com/en-us/sql/relational-databases/in-memory-oltp/garbage-collection-in-memory-optimized-tables>
2. Oracle. (2022). Managing Memory for In-Memory Tables. Retrieved from <https://docs.oracle.com/en/database/oracle/oracle-database/21/solutions/managing-memory-in-memory-tables.html>
3. IBM. (2022). Garbage Collection for In-Memory Tables. Retrieved from <https://www.ibm.com/docs/en/db2-for-zos/12?topic=collection-garbage-in-memory-tables>
4. PostgreSQL. (2022). In-Memory Tables and Garbage Collection. Retrieved from <https://www.postgresql.org/docs/13/in-memory-tables.html>
5. SAP. (2022). Garbage Collection for In-Memory Databases. Retrieved from <https://help.sap.com/viewer/4e8c82dbbf48407f9a86e46a7a0e22c7/2.0.03/en-US/4e8c82dbbf48407f9a86e46a7a0e22c7.html>

## 9. Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-02-14 | Initial documentation |