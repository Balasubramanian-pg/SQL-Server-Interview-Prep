# 27. CASE Expressions (Simple vs Searched)

### 1. The Anchor
* **One-Sentence Pitch:** The `CASE` expression is SQLâ€™s native "if-then-else" logic, used to return specific values based on the evaluation of defined conditions within a query.
* **Category:** Technical Skill / SQL Development

### 2. The Mechanics
* **Key Detail A: Simple CASE Expressions:** This format compares a single expression to a set of simple values. It uses an equality comparison (`=`) exclusively. It is concise but limited to checking if a column or variable matches specific, discrete constants.
    * *Syntax:* `CASE expression WHEN value1 THEN result1 [ELSE resultN] END`
* **Key Detail B: Searched CASE Expressions:** This format evaluates a list of Boolean expressions (predicates) to determine the result. It is significantly more powerful as it supports range comparisons (`>`, `<`), logical operators (`AND`, `OR`), `IS NULL` checks, and `LIKE` patterns.
    * *Syntax:* `CASE WHEN condition1 THEN result1 [ELSE resultN] END`
* **The Logic:** `CASE` expressions are evaluated in the order they are written (top-down). The first condition that evaluates to `TRUE` determines the result, and subsequent conditions are ignored. If no conditions are met and no `ELSE` clause is provided, the expression returns `NULL`. This solves the problem of data transformation and categorization at the database level, reducing the need for post-processing in the application layer.

> [!IMPORTANT]
> All `THEN` and `ELSE` results in a single `CASE` expression must return compatible data types. For example, you cannot return a `STRING` for one condition and an `INTEGER` for another without explicit casting.

### 3. The Evidence
* **Context (CAR/STAR):** In a previous financial reporting project, the database stored transaction types as cryptic integer codes (e.g., 101, 102, 201), and the business required a report that categorized these into "Revenue," "Expense," or "Internal Transfer" based on both the code and the transaction amount.
* **Action:** I implemented a **Searched CASE expression** within the primary reporting view. I used logic like `WHEN code BETWEEN 100 AND 199 AND amount > 0 THEN 'Revenue'` and `WHEN code = 201 OR amount < 0 THEN 'Expense'`.
* **Result:** This centralized the business logic within the database, ensuring consistency across all BI tools and reducing the complexity of the front-end code by 20%, as developers no longer had to maintain mapping objects.

> [!TIP]
> Use a **Simple CASE** when you are only performing direct equality checks on a single column for better readability. Use a **Searched CASE** for any logic involving multiple columns, null checks, or range-based bucketing.

### 4. The Interview "Pivot"
* **Triggers:** "How do you handle conditional logic in a SELECT statement?", "What is the difference between Simple and Searched CASE?", or "How do you categorize data on the fly?"
* **The Connection:** This topic allows me to demonstrate my ability to write efficient, readable SQL. By explaining the difference between Simple and Searched CASE, I show that I don't just write code that works, but I choose the most appropriate syntax for the specific logic required, ensuring the codebase remains maintainable and performant.

> [!WARNING]
> Be careful with `NULL` values in Simple CASE expressions. Since Simple CASE uses equality (`=`), and `NULL = NULL` is unknown in SQL, a Simple CASE will typically fail to match `NULL`. You must use a Searched CASE with `IS NULL` to handle these scenarios correctly.